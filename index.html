<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classicalia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Global Info Button -->
    <button onclick="showInfoModal()" class="global-info-btn">ℹ️</button>

    <header class="header">
        <div class="header-content">
            <div class="logo">Classicalia</div>
            <div class="subtitle">All things Classics, in one place</div>
            
            <!-- Latin Section -->
            <div class="subject-section">
                <h3 class="subject-heading">Latin</h3>
                <nav class="nav nav-latin">
                    <button class="nav-item active" onclick="showSection('vocab')">Vocabulary Tester</button>
                    <button class="nav-item" onclick="showSection('texts')">Set Texts</button>
                </nav>
            </div>

            <!-- Greek Section -->
            <div class="subject-section">
                <h3 class="subject-heading">Greek</h3>
                <nav class="nav nav-greek">
                    <button class="nav-item" onclick="showSection('greek-vocab')">Vocabulary Tester</button>
                    <button class="nav-item" onclick="showSection('greek-texts')">Set Texts</button>
                </nav>
            </div>

            <!-- Classical Civilisation Section -->
            <div class="subject-section">
                <h3 class="subject-heading">Classical Civilisation</h3>
                <nav class="nav nav-civ">
                    <button class="nav-item" onclick="showSection('civ-topics')">Topics</button>
                    <button class="nav-item" onclick="showSection('civ-resources')">Resources</button>
                </nav>
            </div>
        </div>
    </header>

    <div id="vocab-section">
        <div class="container">
            <!-- Main Quiz Area -->
            <div class="quiz-area">
                <!-- Latin Word Display -->
                <div class="word-display">
                    <div class="latin-word" id="latin-word">aqua</div>
                    <div class="word-info" id="word-info">aquae, f - noun 1</div>
                </div>

                <!-- Answer Input -->
                <div class="answer-section">
                    <input type="text" class="form-control" id="answer-input" placeholder="Enter the English meaning..." autocomplete="off">
                    
                    <div class="btn-group">
                        <button class="btn" onclick="checkAnswer()" id="check-btn">Check Answer</button>
                        <button class="btn btn-secondary hidden" onclick="nextQuestion()" id="next-btn">Next Word</button>
                        <button class="btn btn-warning" onclick="revealAnswer()" id="reveal-btn">Reveal Answer</button>
                    </div>
                    
                    <div id="feedback" class="feedback"></div>
                </div>

                <!-- Progress Section -->
                <div class="progress-section">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    
                    <div>Question <span id="current-question">1</span> of <span id="total-questions">10</span></div>
                    
                    <div class="stats">
                        <div>Score: <span id="score">0</span>/<span id="answered">0</span> (<span id="percentage">0</span>%)</div>
                        <div id="completion-message" class="hidden" style="margin-top: 1rem; padding: 1rem; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; color: #155724;">
                            <strong>Test Complete!</strong><br>
                            <span id="final-message"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Panel -->
            <div class="settings-panel">
                <h3>Test Settings</h3>
                
                <!-- Chapter Selection -->
                <div class="setting-section">
                    <h4>Chapter</h4>
                    <div class="chapter-buttons">
                        <button class="chapter-btn active" data-chapter="all">All</button>
                        <button class="chapter-btn" data-chapter="1">1</button>
                        <button class="chapter-btn" data-chapter="2">2</button>
                        <button class="chapter-btn" data-chapter="3">3</button>
                        <button class="chapter-btn" data-chapter="4">4</button>
                        <button class="chapter-btn" data-chapter="5">5</button>
                        <button class="chapter-btn" data-chapter="6">6</button>
                        <button class="chapter-btn" data-chapter="7">7</button>
                        <button class="chapter-btn" data-chapter="8">8</button>
                        <button class="chapter-btn" data-chapter="9">9</button>
                        <button class="chapter-btn" data-chapter="10">10</button>
                    </div>
                </div>

                <!-- Test Length -->
                <div class="setting-section">
                    <h4>Test Length</h4>
                    <div class="length-buttons">
                        <button class="length-btn active" data-length="10">10</button>
                        <button class="length-btn" data-length="25">25</button>
                        <button class="length-btn" data-length="50">50</button>
                        <button class="length-btn" data-length="all">All</button>
                    </div>
                </div>

                <!-- Chapter Info -->
                <div id="chapter-info" class="chapter-info hidden">
                    <div id="chapter-details"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Set Texts Section -->
    <div id="texts-section" class="hidden">
        <div class="container-texts">
            <h2 style="margin-bottom: 2rem; color: #495057;">OCR GCSE Set Texts</h2>
            
            <div class="text-list">
                <div class="text-card active" onclick="selectText('messalina')">
                    <h3>Messalina</h3>
                    <p>Tacitus, Annals XI.26-38 - The story of Messalina's downfall and execution</p>
                </div>
                <div class="text-card" onclick="selectText('future')" style="opacity: 0.6;">
                    <h3>Coming Soon</h3>
                    <p>Additional set texts will be added here</p>
                </div>
            </div>

            <div class="video-section">
                <div id="messalina-videos">
                    <h3 style="margin-bottom: 2rem; color: #495057;">Messalina Video Tutorials</h3>
                    
                    <div class="video-list">
                        <div class="video-item">
                            <div class="video-title">1. Introduction to Messalina</div>
                            <div class="video-container">
                                <iframe src="https://www.youtube.com/embed/7ZlSWwnVIaE" allowfullscreen></iframe>
                            </div>
                        </div>
                        
                        <div class="video-item">
                            <div class="video-title">2. Historical Context</div>
                            <div class="video-container">
                                <iframe src="https://www.youtube.com/embed/l56H6L2UA9U" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="future-videos" class="hidden">
                    <h3 style="color: #495057;">More Set Texts Coming Soon</h3>
                    <p style="color: #6c757d;">Additional set text resources will be added here.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Greek Vocabulary Section (placeholder) -->
    <div id="greek-vocab-section" class="hidden">
        <div class="container">
            <div style="text-align: center; padding: 3rem; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                <h2 style="color: #495057; margin-bottom: 1rem;">Greek Vocabulary Tester</h2>
                <p style="color: #6c757d;">Coming soon! Greek vocabulary testing will be available here.</p>
            </div>
        </div>
    </div>

    <!-- Greek Texts Section (placeholder) -->
    <div id="greek-texts-section" class="hidden">
        <div class="container">
            <div style="text-align: center; padding: 3rem; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                <h2 style="color: #495057; margin-bottom: 1rem;">Greek Set Texts</h2>
                <p style="color: #6c757d;">Coming soon! Greek set text resources will be available here.</p>
            </div>
        </div>
    </div>

    <!-- Classical Civilisation Topics Section (placeholder) -->
    <div id="civ-topics-section" class="hidden">
        <div class="container">
            <div style="text-align: center; padding: 3rem; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                <h2 style="color: #495057; margin-bottom: 1rem;">Classical Civilisation Topics</h2>
                <p style="color: #6c757d;">Coming soon! Classical Civilisation topic resources will be available here.</p>
            </div>
        </div>
    </div>

    <!-- Classical Civilisation Resources Section (placeholder) -->
    <div id="civ-resources-section" class="hidden">
        <div class="container">
            <div style="text-align: center; padding: 3rem; background: white; border-radius: 8px; border: 1px solid #e9ecef;">
                <h2 style="color: #495057; margin-bottom: 1rem;">Classical Civilisation Resources</h2>
                <p style="color: #6c757d;">Coming soon! Additional Classical Civilisation resources will be available here.</p>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeInfoModal()">&times;</span>
            <div style="display: flex; gap: 1rem; align-items: flex-start; margin-top: 1rem;">
                <img src="images/lmc.jpg" style="width: 120px; height: 120px; border-radius: 50%; flex-shrink: 0; object-fit: cover;" alt="Lawrence McNally">
                <div>
                    <p><strong>salve!</strong> 👋</p>
                    <p>I'm Lawrence and I teach Latin and Classics in Bristol.</p>
                    <p>I have a BA in Ancient History from King's College London, a PGCE in Latin with Classics from the University of Cambridge and an MEd (Transforming Practice) from Darwin College, Cambridge. I am particularly interested in Tacitean studies and the history of memory in classical antiquity. In 2021 I won the Classical Association's 'Outstanding New Teacher' award. I also enjoy creating teacher guides and student workbooks. Please feel free to use my resources!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="vocabulary-data.js"></script>
    <script src="navigation.js"></script>
    <script>
    // Quiz variables
    let currentTestWords = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let questionsAnswered = 0;
    let selectedChapter = 'all';
    let selectedLength = 10;

    // Get words for specific chapter
    function getWordsForChapter(chapter) {
        if (chapter === 'all') {
            return vocabularyData;
        }
        return vocabularyData.filter(word => word.chapter == chapter);
    }

    function updateDisplay() {
        document.getElementById('current-question').textContent = currentQuestionIndex + 1;
        document.getElementById('total-questions').textContent = currentTestWords.length;
        document.getElementById('score').textContent = score;
        document.getElementById('answered').textContent = questionsAnswered;
        
        const percentage = questionsAnswered > 0 ? Math.round((score / questionsAnswered) * 100) : 0;
        document.getElementById('percentage').textContent = percentage;
        
        const progress = ((currentQuestionIndex + 1) / currentTestWords.length) * 100;
        document.getElementById('progress-fill').style.width = progress + '%';
    }

    function createNewTest() {
        const availableWords = getWordsForChapter(selectedChapter);
        
        if (availableWords.length === 0) {
            alert('No words available for the selected chapter.');
            return;
        }
        
        // Determine test length
        let testLength = selectedLength;
        if (selectedLength === 'all' || selectedLength > availableWords.length) {
            testLength = availableWords.length;
        }
        
        const shuffled = [...availableWords];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        
        currentTestWords = shuffled.slice(0, testLength);
        currentQuestionIndex = 0;
        score = 0;
        questionsAnswered = 0;
        
        // Hide completion message
        document.getElementById('completion-message').classList.add('hidden');
        
        // Update chapter info
        updateChapterInfo();
        
        loadQuestion();
    }

    function updateChapterInfo() {
        const infoDiv = document.getElementById('chapter-info');
        const detailsDiv = document.getElementById('chapter-details');
        
        if (selectedChapter === 'all') {
            infoDiv.classList.add('hidden');
        } else {
            const wordCount = getWordsForChapter(selectedChapter).length;
            detailsDiv.innerHTML = `<strong>Chapter ${selectedChapter}</strong><br>${wordCount} words available`;
            infoDiv.classList.remove('hidden');
        }
    }

    function loadQuestion() {
        const word = currentTestWords[currentQuestionIndex];
        document.getElementById('latin-word').textContent = word.latin;
        document.getElementById('word-info').textContent = word.info;
        document.getElementById('answer-input').value = '';
        
        const feedback = document.getElementById('feedback');
        feedback.innerHTML = '';
        feedback.className = 'feedback';
        
        document.getElementById('check-btn').classList.remove('hidden');
        document.getElementById('next-btn').classList.add('hidden');
        document.getElementById('reveal-btn').classList.remove('hidden');
        
        updateDisplay();
        document.getElementById('answer-input').focus();
    }

    function checkAnswer() {
        const userAnswer = document.getElementById('answer-input').value.trim();
        
        // Check if answer is empty
        if (!userAnswer) {
            alert('Please enter an answer first!');
            return;
        }
        
        const word = currentTestWords[currentQuestionIndex];
        const correctAnswer = word.english.toLowerCase();
        const userAnswerLower = userAnswer.toLowerCase();
        
        const feedback = document.getElementById('feedback');
        
        // Split correct answer by commas to handle multiple acceptable answers
        const correctParts = correctAnswer.split(',').map(p => p.trim());
        let isCorrect = false;
        
        for (const correctPart of correctParts) {
            // Split each part by spaces to get individual words
            const correctWords = correctPart.split(/\s+/);
            const userWords = userAnswerLower.split(/\s+/);
            
            // Check if user answer exactly matches any correct part
            if (userAnswerLower === correctPart) {
                isCorrect = true;
                break;
            }
            
            // Check if user answer matches any individual word in the correct answer
            for (const correctWord of correctWords) {
                if (userWords.includes(correctWord)) {
                    isCorrect = true;
                    break;
                }
            }
            
            if (isCorrect) break;
        }
        
        if (isCorrect) {
            feedback.innerHTML = `<strong>Correct!</strong> ✓<br><small>"${word.latin}" = "${word.english}"</small>`;
            feedback.className = 'feedback feedback-correct';
            score++;
        } else {
            feedback.innerHTML = `<strong>Incorrect</strong> ✗<br>You wrote: "<em>${userAnswer}</em>"<br>Correct: "<strong>${word.english}</strong>"`;
            feedback.className = 'feedback feedback-incorrect';
        }
        
        questionsAnswered++;
        updateDisplay();
        
        document.getElementById('check-btn').classList.add('hidden');
        document.getElementById('next-btn').classList.remove('hidden');
        document.getElementById('reveal-btn').classList.add('hidden');
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < currentTestWords.length) {
            loadQuestion();
        } else {
            showCompletion();
        }
    }

    function showCompletion() {
        const percentage = Math.round((score / currentTestWords.length) * 100);
        let message = "";
        
        if (percentage >= 90) {
            message = "Outstanding! Excellent work! 🌟";
        } else if (percentage >= 80) {
            message = "Great job! Well done! 👏";
        } else if (percentage >= 70) {
            message = "Good effort! Keep practising! 📚";
        } else {
            message = "Keep studying! Practice makes perfect! 💪";
        }
        
        const chapterText = selectedChapter === 'all' ? 'all chapters' : `Chapter ${selectedChapter}`;
        
        document.getElementById('final-message').innerHTML = `Final Score: ${score}/${currentTestWords.length} (${percentage}%)<br>${message}<br><small>Test: ${chapterText}</small>`;
        document.getElementById('completion-message').classList.remove('hidden');
        
        document.getElementById('check-btn').classList.add('hidden');
        document.getElementById('next-btn').classList.add('hidden');
        document.getElementById('reveal-btn').classList.add('hidden');
    }

    function revealAnswer() {
        const word = currentTestWords[currentQuestionIndex];
        const feedback = document.getElementById('feedback');
        feedback.innerHTML = `<strong>Answer:</strong> "${word.english}"`;
        feedback.className = 'feedback feedback-revealed';
        
        document.getElementById('check-btn').classList.add('hidden');
        document.getElementById('next-btn').classList.remove('hidden');
        document.getElementById('reveal-btn').classList.add('hidden');
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Chapter button handlers
        document.querySelectorAll('.chapter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all chapter buttons
                document.querySelectorAll('.chapter-btn').forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');
                // Update selected chapter
                selectedChapter = this.dataset.chapter;
                // Create new test
                createNewTest();
            });
        });
        
        // Length button handlers
        document.querySelectorAll('.length-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all length buttons
                document.querySelectorAll('.length-btn').forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');
                // Update selected length
                selectedLength = this.dataset.length === 'all' ? 'all' : parseInt(this.dataset.length);
                // Create new test
                createNewTest();
            });
        });
        
        // Enter key support
        document.getElementById('answer-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const checkBtn = document.getElementById('check-btn');
                const nextBtn = document.getElementById('next-btn');
                
                if (!checkBtn.classList.contains('hidden')) {
                    checkAnswer();
                } else if (!nextBtn.classList.contains('hidden')) {
                    nextQuestion();
                }
            }
        });
        
        // Initialize
        createNewTest();
    });
    </script>
</body>
</html>
